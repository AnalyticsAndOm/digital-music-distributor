SELECT *, DENSE_RANK() OVER(ORDER BY SONGS_LISTENED DESC) USER_RANK
FROM 
(
	SELECT DISTINCT 
		USER_ID, USER_FIRST_NAME, USER_LAST_NAME, USER_GENDER, 
        COUNT(SONG_NAME) SONGS_LISTENED
	FROM EVENTS
	WHERE 
	SONG_NAME IS NOT NULL
	GROUP BY USER_ID, USER_FIRST_NAME, USER_LAST_NAME, USER_GENDER
) SUB_Q6;