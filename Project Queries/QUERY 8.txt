-- CALCULATE THE SUM OF TOTAL TIME SPENT BY EACH CUSTOMER ON THE WEBSITE
SELECT 
	USER_ID, USER_NAME, TOTAL_PLAYTIME_IN_SECONDS,
    DENSE_RANK() OVER(ORDER BY TOTAL_PLAYTIME_IN_SECONDS DESC) AS RANK_BY_DURATION
FROM 
(
	SELECT DISTINCT 
		USER_ID, CONCAT(USER_FIRST_NAME," ",USER_LAST_NAME) AS USER_NAME, 
		ROUND(SUM(SONG_LENGTH_IN_SECONDS) OVER(PARTITION BY USER_ID),2) AS TOTAL_PLAYTIME_IN_SECONDS
	FROM EVENTS
	WHERE SONG_NAME IS NOT NULL
) AS SUB_Q8;