-- GET THE DETAILS OF MOST POPULAR ARTISTS BY THE NUMBER OF LISTENERS
SELECT DISTINCT * FROM
(
	SELECT 
		E.ARTIST_NAME, S.ARTIST_ID, ARTIST_LOCATION, ARTIST_LATITUDE, ARTIST_LONGITUDE,
		COUNT(E.USER_ID) OVER(PARTITION BY E.ARTIST_NAME) AS USERS_NUMBER
    FROM EVENTS E, SONGS s
    WHERE E.ARTIST_NAME = S.ARTIST_NAME 
) AS SUB_Q1
ORDER BY USERS_NUMBER DESC;