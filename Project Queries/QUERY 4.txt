--  THE SONGS THAT HAD THE MOST SESSIONS AMONG EACH USERS
SELECT DISTINCT * FROM
(
	SELECT DISTINCT 
		SONG_NAME, ARTIST_NAME, SONG_LEVEL, 
        COUNT(SESSION_ID) OVER(PARTITION BY SONG_NAME, USER_ID) REPEAT_COUNT
	FROM EVENTS
) SUB_Q4
WHERE SONG_NAME IS NOT NULL 
ORDER BY REPEAT_COUNT DESC;
