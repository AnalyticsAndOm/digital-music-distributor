-- IDENTIFY THE MOST POPULAR SONGS BY THE COUNT OF LISTENERS
SELECT * FROM
(
	SELECT 
		SONG_ID, E.SONG_NAME, S.ARTIST_ID, E.ARTIST_NAME, E.SONG_LENGTH_IN_SECONDS, 
		COUNT(USER_ID) OVER(PARTITION BY SONG_ID) USERS_NUMBER
	FROM EVENTS E, SONGS S
	WHERE E.ARTIST_NAME = S.ARTIST_NAME
) SUB_Q2 
ORDER BY USERS_NUMBER DESC;